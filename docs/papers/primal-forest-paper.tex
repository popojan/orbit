\documentclass[11pt]{article}
\usepackage{amsmath,amssymb,amsthm}
\usepackage{graphicx}
\usepackage{xcolor}
\usepackage{tikz}
\usepackage[margin=1in]{geometry}
\usepackage{listings}
\usepackage{hyperref}

\title{The Primal Forest:\\
A Journey Through the Sieve of Eratosthenes}

\author{Jan Popelka}

\date{\today}

\begin{document}

\maketitle

\begin{abstract}
We present an educational visualization that transforms the classical Sieve of Eratosthenes from a one-dimensional list into a two-dimensional ``primal forest.'' By mapping divisors according to $n = p(p+k)$ to coordinates $(kp+p^2, kp+1)$, we create an immersive view where you stand at the forest's southern edge looking northward, with divisors of composite numbers appearing as trees at various depths. Prime numbers become visible as clear sight lines---positions where no tree blocks your view through the forest. This geometric perspective makes the structure of the sieve visually intuitive and provides an engaging introduction to multiplicative structure in number theory.
\end{abstract}

\section{Introduction: Why Are Primes So Hard to Find?}

Prime numbers are the atoms of arithmetic---every whole number breaks down into a unique product of primes. Yet despite their fundamental importance, primes seem to appear unpredictably along the number line:

\[
2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, \ldots
\]

The gaps between consecutive primes vary: sometimes just 2 (twin primes like 11 and 13), sometimes much larger (there's a gap of 14 between 113 and 127). Is there a pattern hidden in this chaos?

The ancient Greeks developed a clever algorithm---the \emph{Sieve of Eratosthenes}---that systematically finds all primes by eliminating composites. But working through the sieve on a linear list can feel mechanical. \textbf{What if we could \emph{see} the structure?}

Enter the \textbf{Primal Forest}: a geometric transformation that turns the sieve into a visual landscape where divisors form regular patterns and primes appear as clearings. Imagine standing at the southern edge of a vast forest, looking northward into the trees. You can walk west or east along this edge (the x-axis), and at each position, look straight north. Trees represent divisors of numbers at the corresponding x-coordinates, scattered at various depths into the forest. At certain positions along the southern edge, you have a perfectly clear sight line---these are the primes.

This geometric view holds a deeper secret: when we measure distances to these trees carefully, we discover that primality exists on a continuous spectrum, with primes at the boundary and composites stratified by their factorization complexity.

\section{The Classical Sieve (Linear View)}

Let's briefly recall how the Sieve of Eratosthenes works in its traditional form. We list all integers starting from 2:

\[
2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, \ldots
\]

Then we repeatedly:
\begin{enumerate}
\item Mark the first unmarked number as prime
\item Cross out all its multiples (composites)
\item Repeat
\end{enumerate}

For example:
\begin{itemize}
\item Mark 2 as prime, cross out 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, \ldots
\item Mark 3 as prime, cross out 6, 9, 12, 15, 18, 21, 24, \ldots
\item Mark 5 as prime, cross out 10, 15, 20, 25, \ldots
\item And so on\ldots
\end{itemize}

The numbers that remain unmarked are the primes. This works beautifully, but it's a one-dimensional view. Every composite disappears into a crossed-out symbol. Can we visualize the \emph{structure} of why composites get eliminated?

\section{The Geometric Transformation}

Here's the key insight: every composite number can be written as $n = p(p+k)$ for some positive integers $p$ and $k \geq 0$. For example:
\begin{align*}
4 &= 2 \times 2 = 2(2+0) \quad \text{(so } p=2, k=0\text{)} \\
6 &= 2 \times 3 = 2(2+1) \quad \text{(so } p=2, k=1\text{)} \\
8 &= 2 \times 4 = 2(2+2) \quad \text{(so } p=2, k=2\text{)} \\
9 &= 3 \times 3 = 3(3+0) \quad \text{(so } p=3, k=0\text{)}
\end{align*}

Now, instead of placing these composites on a line, we'll place them in a 2D plane using this mapping:

\[
\boxed{n = p(p+k) \quad \mapsto \quad \text{tree at } (kp + p^2,\, kp + 1)}
\]

Let's unpack this:
\begin{itemize}
\item \textbf{x-coordinate}: $kp + p^2 = p(k+p)$ is exactly the composite number $n$ itself
\item \textbf{y-coordinate}: $kp + 1$ is chosen to spread the points vertically in a regular pattern
\end{itemize}

\subsection{Why This Coordinate Choice?}

The y-coordinate $kp + 1$ isn't arbitrary---it creates a \textbf{regular, square-like forest}. As we plot points for different values of $k$ and $p$, they form a symmetric grid pattern. In fact, if we reflect the entire forest across the x-axis (flipping $y \to -y$), the gaps (prime positions) remain unchanged! This symmetry reveals the deep regularity in how factorizations are distributed.

\textbf{Note}: We could also plot the case $p=1$ (which gives the sequence $k+1$ along the main diagonal), but omitting it makes the pattern clearer: \emph{every dot is a factorization, and primes are the absences}. This forces active reasoning rather than passive recognition.

\section{The Forest Emerges}

Figure~\ref{fig:forest} shows the primal forest for the range $n \leq 31$. We plot only factorizations with $p \geq 2$---the pure factorization lattice.

\begin{figure}[h]
\centering
\includegraphics[width=0.8\textwidth]{../../visualizations/primal-forest-31.pdf}
\caption{The Primal Forest: You stand at the southern edge (bottom of diagram, y=0) and can walk west-east (left-right, x-axis). At each position, you look straight north (upward in diagram, y-axis). Each dot represents a factorization $n = p(p+k)$ with $p \geq 2$, plotted at coordinates $(kp+p^2, kp+1)$. Prime numbers are the x-coordinates with \emph{clear sight lines}---no composite trees block your view at any depth northward.}
\label{fig:forest}
\end{figure}

\subsection{What Are We Seeing?}

\begin{itemize}
\item \textbf{Trees}: Each tree corresponds to one divisor $p$ of a number $n$, where $2 \leq p \leq \sqrt{n}$. Specifically, for $n = p \times (p+k)$, a tree is planted at position $(kp+p^2, kp+1)$. The y-coordinate $(kp+1)$ represents how deep into the forest this divisor stands. The number of trees at x-coordinate $n$ equals the number of divisors of $n$ in the range $[2, \sqrt{n}]$. These trees form the forest that may block your sight line.

\item \textbf{Your position}: You stand at position $(x, 0)$ on the southern edge---literally at y=0. You can walk west-east to choose which x-coordinate to test, then look straight north into the forest. Most positions have at least one tree somewhere north of you. But some positions have \emph{no trees at any depth northward}. These are the \textbf{primes}! They're numbers with clear sight lines through the forest.

\item \textbf{The primality test}: Stand at any x-coordinate along the southern edge and look straight north. If you see trees blocking your view at any depth, that number is composite. If you have a perfectly clear sight line through the forest, that number is prime.
\end{itemize}

\subsection{The Core Insight}

\begin{quote}
\textbf{The number of trees at position n (across all depths) equals the number of divisors of n in the range $[2, \sqrt{n}]$. Primes have zero such divisors, so they offer clear sight lines through the forest.}
\end{quote}

For example:
\begin{itemize}
\item $n = 18 = 2 \times 9 = 3 \times 6$: divisors in $[2, \sqrt{18}] = [2, 4.24]$ are $\{2, 3\}$, so \textbf{2 trees} block your view
\item $n = 16 = 2 \times 8 = 4 \times 4$: divisors in $[2, \sqrt{16}] = [2, 4]$ are $\{2, 4\}$, so \textbf{2 trees} block your view
\item $n = 13$ (prime): no divisors in $[2, \sqrt{13}] = [2, 3.6]$, so \textbf{clear sight line}
\end{itemize}

The forest isn't just showing which numbers are composite---it's counting their small divisors geometrically.

\section{Exploring the Forest}

\subsection{Forest Geometry: Regular Diagonals from Parabolic Layers}

The key insight of this visualization lies in a surprising geometric paradox. While the classical Sieve of Eratosthenes progressively crosses out multiples of primes, the Primal Forest plants \textbf{every number $p \geq 2$} into a regular diagonal row:

\begin{quote}
Each $p$ (prime or composite) generates a diagonal of factorizations $p(p+k)$ for $k = 0, 1, 2, \ldots$\\
Points: $(p^2, 1)$, $(p^2+p, p+1)$, $(p^2+2p, 2p+1)$, $(p^2+3p, 3p+1)$, \ldots\\
Spacing: constant $(p, p)$ in both directions $\Rightarrow$ \textbf{slope exactly 1} (45Â° angle)
\end{quote}

For example:
\begin{itemize}
\item $p=2$: diagonal $(4,1)$, $(6,3)$, $(8,5)$, $(10,7)$, \ldots with spacing $(2,2)$
\item $p=3$: diagonal $(9,1)$, $(12,4)$, $(15,7)$, $(18,10)$, \ldots with spacing $(3,3)$
\item $p=5$: diagonal $(25,1)$, $(30,6)$, $(35,11)$, $(40,16)$, \ldots with spacing $(5,5)$
\end{itemize}

\textbf{The paradox}: Horizontal ``layers'' (points with fixed $k$) form \emph{parabolic sequences}---perfect squares $p^2$ for $k=0$, shifted parabolas for $k>0$. Yet from these parabolic layers emerges a perfectly \emph{regular diagonal structure} with slope 1!

Composite numbers with multiple factorizations appear multiple times. For example, $24 = 2 \times 12 = 3 \times 8 = 4 \times 6$ lies on three different diagonals ($p=2,3,4$) as three trees at different depths.

\subsection{Numbers with Multiple Trees}

The more ways a number can factor, the more trees block your view. Prime powers ($9, 25$) have one tree, semiprimes ($15$) two, highly composite numbers ($36$) four. Primes have no such divisors and offer clear sight lines.

\subsection{The Parabolic Curve and Growing Gaps}

Notice how the forest extends deeper (further north) as numbers grow? The x-coordinate $kp + p^2$ has a quadratic term $p^2$, creating a parabolic arrangement. This reveals a profound truth about prime distribution:

\begin{quote}
\textbf{The higher the x-coordinate (the larger the number), the deeper the forest extends northward. More trees at various depths means higher probability that some tree blocks your sight line.}
\end{quote}

As we walk east along the southern edge (increasing x), the forest grows denser and extends further north. More factors mean more trees, scattered across a greater depth range. The chance of finding a completely clear sight line---a prime---decreases. This geometric view makes the Prime Number Theorem intuitive: \emph{primes thin out} because the ``forest of factors'' grows denser and deeper.

\section{Try It Yourself}

Here's the Wolfram Language code that generates the forest:

\begin{lstlisting}[language=Mathematica, basicstyle=\small\ttfamily]
(* Generate all composite points up to n *)
comp1[m_, n_] := Join @@ Table[
  {k*p + p^2, k*p + 1},
  {k, 0, n},
  {p, Max[1, Ceiling[1/2 (-k + Sqrt[k^2 + 4*m])]],
      Floor[1/2 (-k + Sqrt[k^2 + 4*n])]}
]

(* Visualize the forest *)
lpl[hi_] := ListPlot[
  GatherBy[#, PrimeQ@*First],
  PlotRange -> {Automatic, {-1/2, Automatic}},
  AxesOrigin -> {0, 0},
  AspectRatio -> 1,
  PlotMarkers -> {Automatic, Large},
  GridLines -> {Range@hi - 1/2, Range[0, hi] - 1/2},
  Epilog -> {Thick, ColorData[97, "ColorList"][[2]],
    Line[{#, {First@#, 0}}] & /@
      Select[#, PrimeQ@*First]}
] &@ comp1[1, hi]

(* Generate the plot *)
lpl@31
\end{lstlisting}

\subsection{Exercises}

\begin{enumerate}
\item \textbf{The Twin Prime Hunt}: Stand at position 11. Walk east slowly. The next clear sight line is at 13---just 2 steps away (twin primes!). Keep walking and find more twin pairs. Can you predict where twins might appear by studying the forest structure? Is there a pattern to how twin primes are spaced?

\item \textbf{The Goldbach Exploration}: Pick an even number's position, say 20. Can you find two prime positions that sum to 20? For example, $3+17=20$. Try other even numbers. Does this always work? What does the forest tell you about additive structure?

\item \textbf{Modify the Forest}: What if you included $p=1$ trees in the visualization? Or what if you plotted only odd composites? Build these variations and describe what changes. Does removing certain trees make patterns more or less obvious? What does this tell you about the role of small primes?

\item \textbf{Visual Prediction Challenge}: Without computing factorizations, look at the forest pattern for $n \leq 30$ and predict: will position 91 have a clear sight line? What about 97? Explain your reasoning using only what the visual pattern shows you. Then check your predictions.

\item \textbf{The Density Investigation}: Count how many trees appear in regions 1-30, 31-60, and 61-90. Plot trees-per-unit as a function of position. What trend do you observe? Can you explain why the forest density changes this way? How does this relate to the Prime Number Theorem?
\end{enumerate}

\section{Connections to Other Visualizations}

The Primal Forest joins a family of geometric prime visualizations:

\begin{itemize}
\item \textbf{Ulam Spiral} (1963): Arrange integers in a spiral; primes cluster along diagonal lines
\item \textbf{Sacks Spiral}: Arrange integers on an Archimedean spiral; primes form curved patterns
\item \textbf{Prime Grids}: Various 2D arrangements revealing structure
\item \textbf{Primal Forest}: Composites as a regular lattice, primes as gaps
\end{itemize}

Each visualization highlights different aspects of prime distribution. The forest metaphor is particularly intuitive: \textbf{primes aren't randomly scattered---they're the gaps left behind when composites are systematically placed.}

\section{Educational Value}

This visualization helps answer common student questions:

\paragraph{Q: Why are primes ``special''?}
A: Primes are the only numbers with clear sight lines. They're fundamentally different from composites.

\paragraph{Q: Why do prime gaps grow?}
A: The forest extends deeper and grows denser as numbers increase. Sight lines become rarer, and gaps between primes naturally widen.

\paragraph{Q: Is there a pattern to primes?}
A: Yes! Primes are precisely the gaps in the regular factor lattice. The pattern is visible once we map factorizations to 2D.

\paragraph{Q: Why does the probability of finding a prime decrease?}
A: As numbers grow, they have more factors. The forest extends deeper and becomes denser. More trees at more depths block sight lines, so primes become rarer.

\section{The Regularity Paradox}

\begin{center}
\fbox{\begin{minipage}{0.9\textwidth}
\vspace{0.5em}
\textbf{A Profound Mystery Made Visible}

The Primal Forest reveals a stunning paradox at the heart of prime distribution:

\begin{itemize}
\item \textbf{Input}: Perfectly regular diagonal patterns
  \begin{itemize}
  \item Multiples of 2: evenly spaced at intervals of 2
  \item Multiples of 3: evenly spaced at intervals of 3
  \item Multiples of 5: evenly spaced at intervals of 5
  \item Each prime generates its own perfectly uniform lattice
  \end{itemize}

\item \textbf{Transformation}: Simple quadratic offset $p^2 + kp$
  \begin{itemize}
  \item Completely deterministic
  \item No randomness, no chaos in the rule itself
  \item Just shifts each diagonal row by a parabolic curve
  \end{itemize}

\item \textbf{Output}: The mysterious distribution of primes
  \begin{itemize}
  \item Gaps of 2, 4, 6, 14, 34, 72, \ldots
  \item Twin primes appearing unpredictably
  \item The subject of the Riemann Hypothesis
  \item One of mathematics' deepest unsolved problems
  \end{itemize}
\end{itemize}

\textbf{The question}: How can overlaying infinitely many perfectly regular patterns, offset by a simple quadratic, create something as complex and mysterious as the prime distribution?

You can \emph{see} the regular structure. Each factor creates predictable rows. The overlay is deterministic. Yet the gaps---the primes---resist prediction. This visualization doesn't resolve the mystery; it \emph{reveals} it. Perhaps that's the deepest lesson: \textbf{simple geometric rules can generate irreducible complexity.}

This is why the geometric view, despite its clarity, doesn't unlock new computational shortcuts for finding primes. The gaps are what remain after infinite superposition of regular patterns---a non-local, globally emergent phenomenon. Each prime's existence depends on escaping \emph{all} factor rows, which is equivalent to the original primality question, just visualized geometrically.
\vspace{0.5em}
\end{minipage}}
\end{center}

\section{A Note for Educators: Left-Brain Algorithms, Right-Brain Patterns}

\subsection{Why Isn't This Taught in Schools?}

The Sieve of Eratosthenes is a staple of mathematics education, yet it's almost universally presented as a \emph{linear, sequential algorithm}: list the numbers 2, 3, 4, 5, \ldots on a line, then systematically cross out multiples. This approach engages \textbf{left-brain sequential processing}---step 1, step 2, follow the procedure, arrive at the answer.

The Primal Forest offers something fundamentally different: a \textbf{right-brain spatial pattern}\footnote{Note: The division into "left analytical" and "right creative" hemispheres is a simplified popular-science model. In reality, both hemispheres work intensively together on most cognitive tasks. This is a pedagogical metaphor. See \href{https://en.wikipedia.org/wiki/Lateralization_of_brain_function}{en.wikipedia.org}} where the entire structure is visible at once. Instead of "cross out the next composite," students see "composites form a regular lattice; primes are the gaps."

So why hasn't this geometric view entered the mainstream curriculum?

\paragraph{Historical Inertia}
Mathematics education evolved from oral and written traditions where you could only show one number at a time. The linear sequence 2, 3, 4, 5, 6, \ldots is what fits on papyrus, a chalkboard line, or a printed page. Two-dimensional visualizations require tools (graph paper, plotting, color) that weren't readily available until recently.

\paragraph{Computational Bias}
The sieve is traditionally taught as an \emph{algorithm}---a method for computing primes efficiently. Schools emphasize ``how to find primes'' (a procedural skill) over ``why primes behave this way'' (conceptual understanding). The linear method is indeed easier to implement by hand.

\paragraph{Assessment Compatibility}
Linear algorithms are straightforward to test: ``Did the student cross out the correct numbers? Did they identify all primes up to 100?'' Spatial understanding is harder to assess: ``Does the student recognize why gaps form? Can they explain the pattern geometrically?'' Traditional testing favors procedural tasks.

\paragraph{Teacher Preparation}
Most mathematics teachers learned the linear sieve themselves and may never have encountered geometric alternatives. Teaching what you know perpetuates the algorithmic tradition. Introducing new visualizations requires professional development, updated materials, and comfort with computational tools.

\subsection{The Educational Opportunity}

The tragedy is that the linear sieve answers \emph{how} questions, while the geometric view answers \emph{why} questions:

\begin{center}
\begin{tabular}{p{6cm}|p{6cm}}
\textbf{Linear Sieve (How)} & \textbf{Primal Forest (Why)} \\ \hline
Cross out multiples of 2 & Multiples form a regular row pattern \\
Cross out multiples of 3 & Each prime generates its own row \\
Primes are what remain & Primes are numbers with no factorization \\
Prime gaps grow larger & Factor density increases with size \\
Keep crossing out\ldots & See the complete structure at once \\
\end{tabular}
\end{center}

These are exactly the questions curious students ask:
\begin{itemize}
\item ``Why do primes thin out?'' $\rightarrow$ The forest grows denser (more factors block your view)
\item ``Why are primes 'special'?'' $\rightarrow$ They're gaps in the factor lattice (no factorizations exist)
\item ``Is there a pattern to primes?'' $\rightarrow$ Yes! Composites form a regular geometric structure; primes are the gaps left behind
\end{itemize}

The linear sieve doesn't answer these questions---it just says ``keep following the algorithm until you're done.''

\subsection{Complementary Approaches, Not Replacement}

We're not suggesting the linear sieve should be abandoned. Rather, \textbf{both approaches should be taught}:

\begin{enumerate}
\item \textbf{Linear sieve first}: Hands-on, algorithmic, easy to implement with paper and pencil. Builds procedural fluency and pattern recognition.

\item \textbf{Geometric view second}: Visual, conceptual, reveals structural properties. Deepens understanding and connects to broader mathematical thinking (coordinate systems, function graphs, geometric reasoning).

\item \textbf{Discussion}: Why do both methods work? What does each reveal about primes? Which approach feels more natural to you?
\end{enumerate}

Different students think differently. Some will ``get'' primes from the algorithm. Others will ``get'' them from the visualization. Some need both. Why force everyone into a single mode?

\subsection{Tools Make It Possible}

With modern computational tools---Wolfram Language, Python with matplotlib, GeoGebra, Desmos, interactive notebooks---creating and exploring these visualizations is now \emph{trivial}. Students can:
\begin{itemize}
\item Generate forests for different ranges
\item Zoom in on specific regions
\item Experiment with modified coordinates
\item Create animations showing how the pattern builds
\item Discover patterns on their own
\end{itemize}

The barrier isn't technology anymore. The barrier may be lack of awareness that such visualizations exist, or reluctance to deviate from the traditional curriculum.

\subsection{A Call to Action}

If you're an educator reading this, we suggest the following:
\begin{itemize}
\item Try showing the Primal Forest alongside the linear sieve
\item Ask students which view makes more sense to them
\item Use the forest to answer ``why'' questions about prime distribution
\item Encourage students to explore variations and make their own discoveries
\item Share what works with colleagues and curriculum developers
\end{itemize}

The goal isn't to add another topic to an already crowded curriculum. It's to \emph{deepen understanding} of a topic already being taught, by engaging both algorithmic and spatial thinking.

\section{Conclusion}

The Primal Forest transforms the abstract notion of ``sieving out composites'' into a concrete visual experience. By mapping factorizations to coordinates, we see composites form a regular geometric pattern, while primes emerge as the gaps---numbers that don't fit the pattern.

This approach has pedagogical value at multiple levels:
\begin{itemize}
\item \textbf{Elementary}: Visual intuition before algorithms
\item \textbf{Secondary}: Connection between factorization and geometry
\item \textbf{University}: Coordinate transformations reveal structure
\item \textbf{Research}: Alternative perspectives may inspire new approaches
\end{itemize}

The next time you think about primes, imagine standing at the southern edge of a vast forest, walking along trying different positions. At most spots, trees block your view northward at some depth. But occasionally, you find a perfectly clear sight line---no trees at any distance. That's a prime. The forest is regular, but the clearings are mysterious.

Yet the forest has one more secret to reveal. Instead of asking "blocked or clear?", we can ask "how far to the nearest trees?" This continuous perspective transforms our binary classification into a spectrum---and what emerges is worth exploring.

\appendix

\section{A Continuous Primality Spectrum}

The Primal Forest reveals primes as gaps in a discrete lattice---positions with completely clear sight lines. But this binary view (clear or blocked) overlooks a richer structure. What if we instead asked: \emph{how far} are the nearest trees at each depth?

This shift from binary to continuous measurement reveals something unexpected: primality exists on a spectrum. When we compute a distance-based score for each integer, primes rise to form a smooth upper envelope, while composites scatter below, stratified by their factorization complexity. Prime powers cluster near the envelope, semiprimes fall further, and highly composite numbers sink to the bottom.

This is more than a visualization trick. The continuous primality score provides a geometric measure of "how composite" a number is, with primes as the limiting case. While the educational value is clear, this perspective may offer number-theoretic insights into the relationship between factorization structure and prime distribution.

\subsection{From Discrete Gaps to Continuous Distances}

In the main visualization, a number is prime if you have a completely clear sight line northward. We can reformulate this geometrically: for each horizontal "row" at depth $p$ in the lattice, measure the \textbf{horizontal distance} from your position at $x$ to the nearest tree at that depth.

For prime $x$: all distances are positive (no trees directly north of you at any depth)\\
For composite $x$: at least one distance is zero (at least one tree blocks your sight line)

\subsection{The Soft-Min Trick}

Instead of taking the exact minimum distance (which involves discrete floor operations), we can use a \textbf{soft minimum} with temperature parameter $\beta$:

\begin{equation}
d_p^{\text{soft}}(x) = -\beta \log \sum_{k=0}^{\lfloor x/p \rfloor} \exp\left(-\frac{|x - (kp + p^2)|}{\beta}\right)
\end{equation}

As $\beta \to 0$, this approaches the true minimum distance. For moderate $\beta$ (like $\beta = 1/7$), it provides a smooth approximation.

The overall primality score is the product over all $p$:

\begin{equation}
S(x) = \prod_{p=2}^{x} d_p^{\text{soft}}(x)
\end{equation}

We plot $\log(1 + S(x))$ to compress the exponential growth.

\subsection{The Envelope Structure}

Figure~\ref{fig:envelope} shows a remarkable discovery: when we plot this score for all integers, \textbf{primes form a smooth upper envelope}, while composites scatter below it in stratified layers.

\begin{figure}[h]
\centering
\includegraphics[width=0.7\textwidth]{../../visualizations/soft-distance-envelope-127.pdf}
\caption{The primality spectrum: primes (orange) form a smooth envelope, composites (blue) scatter below. Each composite's distance from the envelope encodes its factorization structure.}
\label{fig:envelope}
\end{figure}

\subsection{Factorization as Depth}

Figure~\ref{fig:stratification} reveals the deeper structure: composites stratify by their number of prime factors (counting multiplicity).

\begin{figure}[h]
\centering
\includegraphics[width=0.7\textwidth]{../../visualizations/soft-distance-composite-types.pdf}
\caption{Composites stratified by type: prime powers closest to envelope, semiprimes further down, many-factor composites at the bottom. Factorization complexity is visible as vertical position.}
\label{fig:stratification}
\end{figure}

\begin{itemize}
\item \textbf{Prime powers} ($p^2, p^3, \ldots$): Closest to envelope
\item \textbf{Semiprimes} ($pq$): Medium depth
\item \textbf{3+ factors}: Sink progressively lower
\end{itemize}

The gap from the envelope grows with factorization complexity: more factors $\Rightarrow$ lower score $\Rightarrow$ further from ``primeness.''

\subsection{Why the Geometric View Is Essential}

Interestingly, defining the soft distance product using classical modular arithmetic (distance to multiples of $p$) produces completely different behavior---it doesn't create the envelope structure at all! The \textbf{geometric lattice formulation} $(kp + p^2, kp+1)$ is essential for this visualization to work.

This suggests the 2D coordinate transformation captures something fundamental about the factorization structure that isn't visible in the classical 1D view.

\subsection{Implementation}

Here's the Wolfram Language code:

\begin{lstlisting}[language=Mathematica, basicstyle=\small\ttfamily]
(* Soft distance product with temperature beta *)
DistanceProductSoft[x_, beta_: 1/7] :=
  Product[
    -beta * Log @ Sum[
      Exp[-Abs[x - (k*p + p^2)]/beta],
      {k, 0, Floor[x/p]}
    ],
    {p, 2, x}
  ]

(* Plot the primality spectrum *)
pp[hi_] :=
  Table[{k, Log[1 + DistanceProductSoft[k, 1/7]]}, {k, 1, hi}] //
    ListLinePlot[
      GatherBy[#, PrimeQ@*First],
      PlotMarkers -> Automatic,
      GridLines -> {Prime @ Range @ PrimePi @ hi, None},
      Frame -> True,
      FrameLabel -> {"n", "score"}
    ] &

pp[127]  (* Generate the plot *)
\end{lstlisting}

\subsection{Educational Value}

This continuous primality spectrum offers complementary insights to the discrete forest:

\begin{itemize}
\item The forest shows \emph{why} composites exist (factorizations place dots)
\item The spectrum shows \emph{how close} each number is to being prime
\item Prime powers are ``almost prime'' (high scores)
\item Highly composite numbers are ``very composite'' (low scores)
\item The smooth envelope reveals regularity in prime distribution
\end{itemize}

\subsection{A Note on Computational Complexity}

As emphasized in the main text, this visualization doesn't provide computational shortcuts. Computing $S(x)$ still requires checking all $p$ from $2$ to $x$, which is $O(x)$ operations---worse than the standard Sieve of Eratosthenes at $O(x \log \log x)$.

The soft-min approach makes the discrete problem continuous, which is beautiful for visualization and mathematical analysis, but doesn't reduce computational complexity. The geometric reformulation reveals structure; it doesn't dissolve the computational hardness.

\subsection{Open Questions}

\begin{enumerate}
\item What is the growth rate of the prime envelope? Can it be expressed in closed form?
\item Is the stratification by $\Omega(n)$ (number of prime factors) exact, or do layers overlap?
\item Does the envelope have connections to the Riemann zeta function or other classical prime-distribution functions?
\item Can the continuous score be used to define a meaningful ``distance metric'' on the integers?
\item Are there other coordinate transformations that produce different but equally interesting continuous spectra?
\end{enumerate}

\subsection{Conclusion of Appendix}

The Primal Forest shows primes as absences---gaps in a regular lattice. The soft distance product shows primes as \emph{extremes}---the upper boundary of a continuous primality landscape. Both views emerge from the same geometric transformation, revealing different facets of the same underlying structure.

This is the power of geometric reformulation: not to solve the problem faster, but to see it from angles that reveal hidden patterns. The regularity paradox persists---simple rules, irreducible complexity---but now we see that complexity has \emph{layers}, a continuous spectrum from prime to highly composite.

The visualization doesn't answer \emph{how} to find primes efficiently, but it does answer \emph{what} primality looks like when viewed through the lens of geometric distance. And sometimes, seeing the pattern clearly is a discovery in itself.

\section*{Acknowledgments}

This visualization emerged from recreational explorations in computational number theory. Thanks to the Wolfram Language community for tools that make such experiments delightful.

\end{document}
